# üîç –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ DNS –∏ –ø–æ—á—Ç—ã –¥–ª—è watchapps.ru

**–î–∞—Ç–∞**: $(date +"%Y-%m-%d %H:%M:%S")

## üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ DNS

### 1. SPF –∑–∞–ø–∏—Å—å
**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
**–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: 
```
v=spf1 ip4:37.140.192.190 a mx include:_spf.hosting.reg.ru ~all
```

**–ü—Ä–æ–±–ª–µ–º–∞**: IP `81.177.139.192` (—Ç–µ–∫—É—â–∏–π IP —Å–µ—Ä–≤–µ—Ä–∞) **–ù–ï –Ω–∞–π–¥–µ–Ω** –≤ SPF –∑–∞–ø–∏—Å–∏

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**:
```
v=spf1 ip4:37.140.192.190 ip4:81.177.139.192 a mx include:_spf.hosting.reg.ru ~all
```

### 2. A –∑–∞–ø–∏—Å—å –¥–ª—è mail.watchapps.ru
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
**–ó–Ω–∞—á–µ–Ω–∏–µ**: `81.177.139.192`
**–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ**: –°–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–∫—É—â–∏–º IP —Å–µ—Ä–≤–µ—Ä–∞

### 3. MX –∑–∞–ø–∏—Å–∏
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã
**–ó–Ω–∞—á–µ–Ω–∏–µ**: 
- `10 mx1.hosting.reg.ru.`
- `20 mx2.hosting.reg.ru.`

### 4. DMARC –∑–∞–ø–∏—Å—å
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
**–ó–Ω–∞—á–µ–Ω–∏–µ**: `v=DMARC1; p=none; rua=mailto:dmarc@watchapps.ru`

### 5. DKIM –∑–∞–ø–∏—Å—å
**–°—Ç–∞—Ç—É—Å**: ‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω–∞
**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ª—É—á—à–µ–π –¥–æ—Å—Ç–∞–≤–ª—è–µ–º–æ—Å—Ç–∏

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π –ø–æ—á—Ç—ã

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞**: –ü–∏—Å—å–º–∞ –Ω–µ –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –≤–Ω–µ—à–Ω–∏–º SMTP —Å–µ—Ä–≤–µ—Ä–∞–º.

**–û—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö**:
- `connect to mxs.mail.ru[217.69.139.150]:25: Connection timed out`
- `connect to mx2.hosting.reg.ru[31.31.194.241]:25: Connection timed out`

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
1. –ü–æ—Ä—Ç 25 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º/—Ö–æ—Å—Ç–∏–Ω–≥–æ–º
2. Firewall –±–ª–æ–∫–∏—Ä—É–µ—Ç –∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–∞ –ø–æ—Ä—Ç 25
3. –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SMTP relay (–≤–Ω–µ—à–Ω–∏–π –ø–æ—á—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä)

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

- ‚úÖ Postfix —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∞–∫—Ç–∏–≤–µ–Ω
- ‚úÖ Laravel Mail –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ –ü–∏—Å—å–º–∞ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è Postfix –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
- ‚úÖ DNS –∑–∞–ø–∏—Å–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –û–±–Ω–æ–≤–∏—Ç—å SPF –∑–∞–ø–∏—Å—å (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
–î–æ–±–∞–≤—å—Ç–µ IP `81.177.139.192` –≤ SPF –∑–∞–ø–∏—Å—å –≤ DNS.

### 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMTP Relay (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
–ü–æ—Å–∫–æ–ª—å–∫—É –ø–æ—Ä—Ç 25 –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π SMTP —Å–µ—Ä–≤–µ—Ä:

**–í–∞—Ä–∏–∞–Ω—Ç A: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SMTP —Ö–æ—Å—Ç–∏–Ω–≥–∞ (reg.ru)**
–û–±–Ω–æ–≤–∏—Ç–µ `.env`:
```env
MAIL_MAILER=smtp
MAIL_HOST=smtp.hosting.reg.ru
MAIL_PORT=587
MAIL_USERNAME=noreply@watchapps.ru
MAIL_PASSWORD=your-password
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=noreply@watchapps.ru
MAIL_FROM_NAME="WatchApps"
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å**
- Mailgun
- Postmark
- AWS SES
- SendGrid

### 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Postfix Relay (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)
–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Postfix, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ relay —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π SMTP.

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-----------|--------|------------|
| DNS SPF | ‚ö†Ô∏è | –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å IP 81.177.139.192 |
| DNS A | ‚úÖ | –ü—Ä–∞–≤–∏–ª—å–Ω–æ |
| DNS MX | ‚úÖ | –ü—Ä–∞–≤–∏–ª—å–Ω–æ |
| DNS DMARC | ‚úÖ | –ü—Ä–∞–≤–∏–ª—å–Ω–æ |
| DNS DKIM | ‚ùå | –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| Postfix | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω–µ –º–æ–∂–µ—Ç –¥–æ—Å—Ç–∞–≤–∏—Ç—å |
| Laravel Mail | ‚úÖ | –ù–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ |
| –î–æ—Å—Ç–∞–≤–∫–∞ –ø–∏—Å–µ–º | ‚ùå | –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ—Ä—Ç–æ–º 25 |

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–û–±–Ω–æ–≤–∏—Ç—å SPF –∑–∞–ø–∏—Å—å** –≤ DNS
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMTP Relay** —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å –∏–ª–∏ —Ö–æ—Å—Ç–∏–Ω–≥
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É** –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏



