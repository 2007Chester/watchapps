# Инструкции по перезапуску серверов

## Проблема
Next.js запущен в production режиме (`next start`), поэтому изменения в коде не применяются автоматически.

## Решение

### Вариант 1: Пересобрать и перезапустить в production режиме

```bash
# 1. Остановите текущий Next.js сервер (Ctrl+C или найдите процесс и убейте)
pkill -f "next start"

# 2. Перейдите в директорию фронтенда
cd /var/www/watchapps/frontend

# 3. Пересоберите приложение
npm run build

# 4. Запустите в production режиме
npm start
# или
next start -p 3000
```

### Вариант 2: Запустить в dev режиме (рекомендуется для разработки)

```bash
# 1. Остановите текущий Next.js сервер
pkill -f "next start"

# 2. Перейдите в директорию фронтенда
cd /var/www/watchapps/frontend

# 3. Запустите в dev режиме (изменения применяются автоматически)
npm run dev
```

### Laravel сервер

Laravel сервер уже перезапущен. Если нужно перезапустить вручную:

```bash
cd /var/www/watchapps/backend
php artisan serve --host=0.0.0.0 --port=8000
```

## Проверка

После перезапуска:
1. Откройте браузер и перейдите на страницу регистрации
2. Откройте консоль разработчика (F12)
3. Попробуйте зарегистрироваться
4. Проверьте консоль - должны увидеть отладочные сообщения `[apiFetch]` с правильными URL

## Что было исправлено

1. ✅ Добавлен маршрут `/api/sanctum/csrf-cookie` в API routes
2. ✅ Добавлена нормализация `API_URL` для предотвращения двойного `/api/api/`
3. ✅ Добавлена нормализация пути в `apiFetch`
4. ✅ Добавлена финальная проверка URL перед запросом
5. ✅ Добавлено отладочное логирование

